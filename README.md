# PAF-prediction
Real-time electrocardiography (ECG) based paroxysmal atrial fibrillation (PAF) prediction can help doctors take precautions to prevent the onset of PAF. However, vast amount of streaming data collecting from continuous ECG monitoring is captured in real-time, which brings increasingly challenging to model such data. Besides, most existing methods rely on a long-term (around 30 minutes) fragment of ECG sequence and require complex ECG signal preprocessing, making real-time prediction difficult. In this study, we propose a real-time PAF prediction method, which can predict the onset of PAF at least 45 minutes in advance based on only one-minute ECG sequence. Firstly, the probabilistic symbolic pattern recognition (PSPR) method is introduced to extract the global pattern transition features of the 8Hz-sampling ECG segment, and generate the pattern transition probabilistic matrixes (PTPMs). Secondly, the generated PTPMs are then fed into our proposed hybrid network of two-dimensional convolution neural network (CNN) and long short-term memory (LSTM) for automatic feature extraction and prediction, and an ensemble learning model based on CNN-LSTM is trained for better generalization ability. Besides, considering real-time needs and horizontal scalability, reading of ECG streaming data, calculation of PTPMs and model prediction are all implemented on the Spark Streaming engine, which makes the total delay of prediction is around 2 seconds. The accuracy, sensitivity, and specificity of the proposed method on the public 2001 PAF prediction challenge database are 91.26%, 82.21%, and 95.79%, respectively, which outperforms our three baseline models and methods of some literatures using the same dataset. 
Keywords: Paroxysmal Atrial Fibrillation (PAF); Prediction, Probabilistic Symbolic Pattern Recognition; Convolutional Neural Networks (CNN); Long Short-Term Memory (LSTM); Ensemble Learning.
